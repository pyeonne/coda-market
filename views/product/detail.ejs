<!DOCTYPE html>
<html lang="en">

<head>
  <%- include("../layout/head") %>

    <title>Document</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.3/css/all.css"
      integrity="sha384-SZXxX4whJ79/gErwcOYf+zWLeJdY/qpuqC4cAa9rOGUstPomtqpuNWT9wdPEn2fk" crossorigin="anonymous" />
    <link rel="stylesheet" href="/css/base.css" />
    <link rel="stylesheet" href="/css/nav.css" />
    <link rel="stylesheet" href="/css/detail.css" />
</head>

<body onload="check_clicked('<%=isClick%>')">

  <div class="menus">

    <div class="menu1">
      <ul>
        <li><a href="/posts"><i class="fas fa-arrow-left"></a></i></li>
        <li><a href="/posts"><i class="fas fa-home"></a></i></li>
      </ul>
    </div>

    <div class="menu2">
      <li><a href="/posts/<%= post.shortId %>/edit">수정</a></i></li>
      <li><a href="/posts/<%= post.shortId %>/delete">삭제</a></i></li>

      <!-- <button id="modal_btn"><i class="fas fa-ellipsis-v"></button></i> -->
    </div>

  </div>

  <div class="detail-img">
    <ul class="slides">
      <p></p>
      <li><img src="/<%= post.thumbnail %>"></li>
    </ul>
  </div>
  
  <div class="detail-page">

    <div class="detail-ch">

      <div class="detail-info">
        <a href="/mypage"><img src="/img/user.jpg"></a>
        <div class="info-my">
          <span>
            <%= post.author.name %>
          </span>
          <span>
            <%= post.author.location %>
          </span>
        </div>
      </div>


      <!-- <div class="imfo-box">
          <div class="like">
            <i class="far fa-thumbs-up"></i>
            <button class="like-btn" onclick="like_click(1)">좋아요</button>
          </div>
          <div class="dislike">
            <i class="far fa-thumbs-down"></i>
            <button class="dislike-btn" onclick="like_click(2)">싫어요</button>
          </div>

        </div> -->

    </div>
    <hr style="border: solid 1px #f3eeee">

    <div class="defailt-content">
      <div class="content-top">
        <div class='title-top'>
          <h2>
            <%= post.title %>
          </h2>

          <% if(post.isSoldOut==false) { %>
            <div class="product-check check1">
              판매중
            </div>
            <% } else { %>
              <div class="product-check check2">
                판매완료
              </div>
              <% } %>
        </div>
        <div class="content-info">
          <a href="/">
            <%= post.category %>
          </a> · <span id="get_times">10분전</span>
        </div>



      </div>

      <div class="content-mid">
        <p>
          <%= post.content %>
        </p>
      </div>

      <div class="content-bottom">
        <p><i class="fas fa-heart"></i> 10</p>
      </div>
    </div>
    <hr style="border: solid 1px #f3eeee">


    <div class="now-product-list">
      <h4>
        <%= post.author.name %>님의 판매 상품
      </h4>
      <a href="">모두보기</a>
    </div>
    <hr style="border: solid 1px #f3eeee">

    <div class="container">
      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>

      <div class="product-item">
        <a href="/product/detail/"><img src="/img/sample.jpg"></a>
        <div class="product-info">
          <a href="/product/detail/" class="product-title">샘플 데이터</a>
          <span class="product-price">10,000원</span>
        </div>
      </div>


    </div>
  </div>
  <hr style="border: solid 1px #f3eeee">


  <div class="detail-last">
    <div class="last-menu1">
      <div class="menu1-item">
        <button onclick="save_cart('<%= post.shortId %>')"><i class="far fa-heart"></i></i></button>
        <div class="re"></div>
        <div class="dscription">
          <span id="ds-pice">
            <%= post.price %>원
          </span>
          <span id="ds-option">가격 제안 불가</span>
        </div>
      </div>
    </div>

    <div class="last-menu2">
      <a href="">채팅으로 거래하기</a>
    </div>
  </div>

  <script>
    let num = document.querySelector("#ds-pice")
    num.innerText = num.innerText.replace(/\B(?=(\d{3})+(?!\d))/g, ",")

    let save_cart = async (value) => {
      let heart = document.querySelector(".menu1-item > button > i")

      const url = `/cart/${value}`
      await fetch(url, {
        method: 'post',
      })
        .then(res => res.json())
        .then(data => {
          const isClick = data.isClick
          if (isClick) {
            heart.classList.add('save-cart')
          } else {
            heart.classList.remove('save-cart')
          }
        })
    }

    let check_clicked = (isClick) => {
      let heart = document.querySelector(".menu1-item > button > i")
  
      if (isClick === 'true') {
        heart.classList.add('save-cart')
      } else {
        heart.classList.remove('save-cart')
      }
    }

    let content_time = document.querySelector("#get_times")

    const sYear = content_time.substring(11, 15);
    const sMonth = content_time.substring(5, 7);
    const sDate = content_time.substring(8, 10);
    const sHour = content_time.substring(11, 13);
    const sMinute = content_time.substring(14, 16);
    const sSecond = content_time.substring(17, 19);

    let like_click = (value) => {

      if (value === 1) {
        let data = document.querySelector(".like > i")
        let btnData = document.querySelector(".like-btn")
        data.classList.toggle("like-on");
        btnData.classList.toggle("like-on");

      } else {
        let data = document.querySelector(".dislike > i")
        let btnData = document.querySelector(".dislike-btn")
        data.classList.toggle("dislike-on");
        btnData.classList.toggle("dislike-on");
      }
      
    }

  </script>
</body>

</html>